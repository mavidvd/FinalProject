USE FLIGHTS;

CREATE TABLE FLIGHTS19 (
	ROUTE CHAR(7),
    MON INT,
    CARRIER CHAR(2),
    DEP CHAR(3),
    DEPST CHAR(2),
    ARR CHAR(3),
    ARRST CHAR(2),
    DELAY INT,
    FLIGHTS INT,
    DIST INT
);

# SHOW THE TOP 30 AIRPORTS IN US BY NUMBER OF NATIONAL FLIGHTS DEPARTING THROUGHOUT THE YEAR.

SELECT
	DEP AS AIRPORT,
    SUM(FLIGHTS) AS DEP_FL
FROM
	FLIGHTS19
GROUP BY 1
ORDER BY 2 DESC
LIMIT 30;

# 30 BUSIEST AIRPORTS.

SELECT
	DEP
FROM
	FLIGHTS19
GROUP BY 1
ORDER BY SUM(FLIGHTS) DESC
LIMIT 30;


SELECT 
	CARRIER,
    AVG(DELAY)
FROM 
	FLIGHTS19
GROUP BY 1
ORDER BY 2 DESC;